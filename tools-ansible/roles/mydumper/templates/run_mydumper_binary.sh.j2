#!/bin/bash
set -e

ulimit -n 1000000

# WARNING: This file was auto-generated. Do not edit!
#          All your edit might be overwritten!
DEPLOY_DIR={{ deploy_dir }}

cd "${DEPLOY_DIR}" || exit 1


exec bin/mydumper --long-query-guard {{ long_query_guard }} \
     -h "{{ master_host }}" \
     -P {{ master_port }} \
     -u "{{ master_user }}" \
     -p "{{ master_password }}" \
     --regex '^(?!(mysql\.|sys\.|information_schema\.|performance_schema\.))' \
     --skip-tz-utc \
     --chunk-filesize {{ chunk_size }} \
     --statement-size {{ statement_size }} \
     --outputdir {{ dump_dir }} \
     2>> "{{ log_dir }}/{{ role_name }}_{{ job_name }}_stderr.log"
